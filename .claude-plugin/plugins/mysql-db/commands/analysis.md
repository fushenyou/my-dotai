---
description: 分析数据并使用 ECharts + HTML + CSS 生成交互式可视化页面
---

# /mysql-db:analysis - 数据分析与可视化

当用户执行此命令时，使用 `mysql-analysis` 技能来分析数据并生成可视化报告。

## 执行步骤

1. **理解分析需求**
   - 确定要分析的表和字段
   - 理解分析维度和指标
   - 确定时间范围（如适用）

2. **执行数据查询**
   - 生成合适的 SQL 查询
   - 获取分析所需的数据
   - 进行数据聚合和统计

3. **分析数据**
   - 计算统计指标（总计、平均、最大、最小）
   - 识别趋势和模式
   - 检测异常值
   - 分析相关性

4. **选择可视化方案**
   - 根据数据类型选择合适的图表
   - 确定图表布局和样式
   - 设计交互方式

5. **生成 HTML 页面**
   - 创建完整的 HTML 文件
   - 集成 ECharts 图表库
   - 添加响应式 CSS 样式
   - 实现图表交互功能

6. **提供洞察和建议**
   - 总结关键发现
   - 提供业务洞察
   - 给出行动建议

## 用户输入

通过 `$ARGUMENTS` 获取用户输入：
- 分析描述（自然语言）
- 可选参数：
  - `--type <chart_type>`: 图表类型（line, bar, pie, scatter 等）
  - `--out <path>`: 输出文件路径

## 示例

```bash
# 销售趋势分析
/mysql-db:analysis 分析最近12个月的销售趋势

# 用户行为分析
/mysql-db:analysis 分析用户的注册和活跃情况

# 产品分析
/mysql-db:analysis 分析各类别产品的销售占比

# 自定义输出
/mysql-db:analysis 按月统计订单金额 --out ./reports/sales-trend.html
```

## 输出格式

```
✅ 数据分析完成

**分析范围**: 最近12个月的订单数据
**数据量**: 15,847 条记录
**分析时间**: 2024-01-23 10:30:00

**数据摘要**:
- 总订单数: 15,847
- 总金额: ¥2,345,678.90
- 平均订单金额: ¥148.02
- 最高月销售额: ¥289,456.00 (12月)
- 最低月销售额: ¥156,789.00 (2月)

**关键发现**:
1. 📈 整体呈上升趋势，月均增长 8.5%
2. 🔥 11-12月为销售旺季，占全年销量的 35%
3. ⚠️ 2月份销售额异常偏低，需调查原因
4. 💡 复购用户占 42%，贡献 68% 的销售额

**趋势分析**:
- Q1: 平稳增长，月均 ¥175,000
- Q2: 快速增长，月均 ¥210,000
- Q3: 稳定增长，月均 ¥245,000
- Q4: 爆发增长，月均 ¥298,000

**可视化报告**:
📄 已生成 HTML 文件: ./reports/analysis-20240123.html

请在浏览器中打开查看完整的交互式图表和详细分析。

**业务建议**:
1. 🎯 加大 Q4 的营销投入，预计可提升 20-30% 销量
2. 📦 为旺季提前备货，避免缺货
3. 🔍 调查 2 月份数据异常原因，避免重复
4. 💌 加强复购用户维护，推出会员计划
5. 📊 建立销售预警机制，及时发现问题
```

## 图表类型选择

| 分析目标 | 推荐图表 | 说明 |
|---------|---------|------|
| 时间趋势 | 折线图 | 展示数据随时间的变化 |
| 分类对比 | 柱状图 | 对比不同类别的数值 |
| 占比分布 | 饼图 | 展示各部分占总体的比例 |
| 多维关系 | 散点图 | 展示两个变量的相关性 |
| 排名 | 条形图 | 水平柱状图，适合类别名称较长 |
| 地理分布 | 地图 | 展示地理位置相关的数据 |
| 流程 | 漏斗图 | 展示转化过程 |
| 层级 | 树图 | 展示层级结构和占比 |

## HTML 页面结构

生成的 HTML 文件包含：

1. **页面头部**
   - 标题和说明
   - 生成时间

2. **数据摘要**
   - 关键指标卡片
   - 趋势标识（上升/下降）

3. **图表区域**
   - 主图表（趋势分析）
   - 次图表（分布分析）
   - 交互功能（缩放、筛选）

4. **数据表格**
   - 详细数据展示
   - 排序和筛选功能

5. **洞察和建议**
   - 关键发现
   - 行动建议

6. **响应式设计**
   - 适配不同屏幕尺寸
   - 移动端友好

## 数据分析维度

### 时间维度
- 按年、季度、月、周、日
- 同比、环比
- 移动平均

### 分类维度
- 产品类别
- 用户类型
- 地区分布

### 数值维度
- 总计、平均
- 最大、最小
- 百分位数
- 标准差

### 关系维度
- 相关性分析
- 转化漏斗
- 归因分析

## 常见分析场景

### 销售分析
- 销售额趋势（折线图）
- 产品类别占比（饼图）
- 区域销售分布（地图）
- 客户价值分层（散点图）

### 用户分析
- 用户增长趋势（折线图）
- 用户活跃度（热力图）
- 用户画像（雷达图）
- 留存率分析（漏斗图）

### 运营分析
- 转化漏斗（漏斗图）
- 渠道对比（柱状图）
- 活跃时段（热力图）
- 内容热度（词云图）

## 最佳实践

1. **数据采样**
   - 大数据集先聚合再可视化
   - 使用 LIMIT 限制数据量
   - 分组统计后展示

2. **配色方案**
   - 使用专业的配色
   - 考虑色盲友好
   - 保持一致性

3. **交互设计**
   - 添加工具提示
   - 支持缩放和筛选
   - 提供数据导出

4. **性能优化**
   - 图表数据点 < 1000
   - 使用数据抽样
   - 懒加载图表

## 重要提示

- ⚠️ HTML 文件需要在浏览器中打开
- ⚠️ 图表使用 CDN，需要网络连接
- ⚠️ 敏感数据需要脱敏处理
- ⚠️ 大数据量会影响性能，建议先聚合
